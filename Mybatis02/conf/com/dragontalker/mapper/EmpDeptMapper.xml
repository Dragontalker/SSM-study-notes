<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.dragontalker.mapper.EmpDeptMapper">

	<!-- <resultMap type="com.dragontalker.bean.Emp" id="empMap">
		<id column="eid" property="eid"/>
		<result column="ename" property="ename"/>
		<result column="age" property="age"/>
		<result column="sex" property="sex"/>
		<result column="did" property="dept.did"/>
		<result column="dname" property="dept.dname"/>
	</resultMap> -->
	
	<!-- 
		<resultMap>: 自定义映射, 处理复杂的表关系 
		<id column="eid" property="eid"/>
		<id>: 设置主键的映射关系, column设置字段名, property设置属性名
		<result column="ename" property="ename" />
		<result>: 设置非主键的映射关系, column设置字段名, property设置属性名
	-->
	
	<resultMap type="com.dragontalker.bean.Emp" id="empMap">
		<id column="eid" property="eid"/>
		<result column="ename" property="ename"/>
		<result column="age" property="age"/>
		<result column="sex" property="sex"/>
		<association property="dept" javaType="com.dragontalker.bean.Dept">
			<id column="did" property="did"/>
			<result column="dname" property="dname"/>
		</association>
	</resultMap>

	<!-- List<Emp> getAllEmp(); -->
	<select id="getAllEmp" resultMap="empMap">
		select e.eid, e.ename, e.age, e.sex, e.did, d.dname from emp e left join dept d on e.did = d.did
	</select>
	
	<resultMap type="com.dragontalker.bean.Emp" id="empMapStep">
		<id column="eid" property="eid"/>
		<result column="ename" property="ename"/>
		<result column="age" property="age"/>
		<result column="sex" property="sex"/>
		<association property="dept" select="com.dragontalker.mapper.DeptMapper.getDeptByDid" column="did"/>
	</resultMap>
	
	<!-- Emp getEmpStep(String eid); -->
	<select id="getEmpStep" resultMap="empMapStep">
		select eid, ename, age, did sex from emp where eid = #{eid}
	</select>
</mapper>